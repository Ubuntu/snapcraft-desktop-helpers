name: test-desktop-helpers-gnome
version: git
summary: Test for desktop helpers gnome launcher
description: |
  A test program for desktop helpers gnome launcher
grade: devel
confinement: strict

plugs:
  gnome-3-26-1604:
    interface: content
    target: $SNAP/gnome-platform
    default-provider: gnome-3-26-1604:gnome-3-26-1604

apps:
  test-gsettings:
    command: bin/desktop-launch $SNAP/test-gsettings
    plugs:
      - gsettings
      - desktop

parts:
  desktop-gnome-platform:
    source: ../../../
    source-subdir: gtk
    plugin: make
    make-parameters: ["FLAVOR=gtk3"]
    build-packages:
      - libgtk-3-dev
    install: mkdir -p $SNAPCRAFT_PART_INSTALL/gnome-platform

  test-gsettings:
    after: [desktop-gnome-platform]
    plugin: nil
    source: .
    install: |
      gcc -o $SNAPCRAFT_PART_INSTALL/test-gsettings -O2 -Wall test-gsettings.c `pkg-config --cflags --libs gio-2.0`
    build-packages:
      - gcc
      - libglib2.0-dev
      - pkg-config
